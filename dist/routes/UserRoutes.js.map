{"version":3,"sources":["routes/UserRoutes.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","Object","defineProperty","exports","express_1","require","User_1","data_1","UserRouter","router","Router","routes","req","res","default","find","users","json","findById","params","id","user","firstname","body","newUser","save","doc","flag","data","catch","err","code","datalib","Data","console","log","update","email","date","Date","error","message","findByIdAndUpdate","new","findByIdAndRemove","get","getUsers","getUser","post","createUser","put","updateUser","delete","deleteUser","userRouter"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst express_1 = require(\"express\");\nrequire('../config/mongodb.connect');\nconst User_1 = require(\"../models/User\");\nconst data_1 = require(\"../lib/data\");\nclass UserRouter {\n    constructor() {\n        this.router = express_1.Router();\n        this.routes();\n    }\n    getUsers(req, res) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const users = yield User_1.default.find();\n            res.json(users);\n        });\n    }\n    getUser(req, res) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const user = yield User_1.default.findById(req.params.id);\n            res.json(user);\n        });\n    }\n    createUser(req, res) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const firstname = req.body;\n            const newUser = new User_1.default(req.body);\n            newUser.save().then((doc) => {\n                res.json({ flag: true, data: doc });\n            }).catch((err) => {\n                if (err.code) {\n                    const datalib = new data_1.Data();\n                    if (err.code == '11000') {\n                        res.json({ flag: false, err: \"Email address is already in use\" });\n                        console.log(datalib.update(\"logs/\", \"usercreation-err-logs\", { flag: false, err: \"Email address is already in use\", email: req.body.email, date: new Date() }));\n                    }\n                    else {\n                        res.json({ flag: false, err: err.error.message });\n                    }\n                }\n                else {\n                    res.json({ flag: false, err: err.error.message });\n                }\n            });\n        });\n    }\n    updateUser(req, res) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = req.params;\n            const user = yield User_1.default.findByIdAndUpdate(id, req.body, { new: true });\n            res.json(user);\n        });\n    }\n    deleteUser(req, res) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { id } = req.params;\n            const user = yield User_1.default.findByIdAndRemove(id);\n            res.json(user);\n        });\n    }\n    routes() {\n        this.router.get('/', this.getUsers);\n        this.router.get('/:id', this.getUser);\n        this.router.post('/', this.createUser);\n        this.router.put('/:id', this.updateUser);\n        this.router.delete('/:id', this.deleteUser);\n    }\n}\nconst userRouter = new UserRouter(); //intialize the iser oruter class\nexports.default = userRouter.router; //export user object property router\n"],"file":"UserRoutes.js"}